<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Surat</title>
    <meta property="og:title" content="Surat" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8" />
    <meta property="twitter:card" content="summary_large_image" />

    <style data-tag="reset-style-sheet">
      html {  line-height: 1.15;}body {  margin: 0;}* {  box-sizing: border-box;  border-width: 0;  border-style: solid;}p,li,ul,pre,div,h1,h2,h3,h4,h5,h6,figure,blockquote,figcaption {  margin: 0;  padding: 0;}button {  background-color: transparent;}button,input,optgroup,select,textarea {  font-family: inherit;  font-size: 100%;  line-height: 1.15;  margin: 0;}button,select {  text-transform: none;}button,[type="button"],[type="reset"],[type="submit"] {  -webkit-appearance: button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner {  border-style: none;  padding: 0;}button:-moz-focus,[type="button"]:-moz-focus,[type="reset"]:-moz-focus,[type="submit"]:-moz-focus {  outline: 1px dotted ButtonText;}a {  color: inherit;  text-decoration: inherit;}input {  padding: 2px 4px;}img {  display: block;}html { scroll-behavior: smooth  }
      
    </style>
    <style>
      .export-container {
        height: 296mm; /* A4 height */
        overflow: hidden;
        page-break-before: always;
        border: none !important; /* Hide border when exporting */
      }
    </style>
    <style data-tag="default-style-sheet">
      html {
        font-family: Noto Sans;
        font-size: 16px;
      }

      body {
        font-weight: 400;
        font-style:normal;
        text-decoration: none;
        text-transform: none;
        letter-spacing: normal;
        line-height: 1.15;
        color: var(--dl-color-theme-neutral-dark);
        background-color: var(--dl-color-theme-neutral-light);

        fill: var(--dl-color-theme-neutral-dark);
      }
    </style>
    <link
      rel="stylesheet"
      href="https://unpkg.com/animate.css@4.1.1/animate.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&amp;display=swap"
      data-tag="font"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=STIX+Two+Text:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&amp;display=swap"
      data-tag="font"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/@teleporthq/teleport-custom-scripts/dist/style.css"
    />
  </head>
  <body>
    <link rel="stylesheet" href="./index.css" />
    <div>
      <link href="./index.css" rel="stylesheet" />

      <div class="home-container">
        <span class="home-text" contenteditable="false">
          <span>BENDAHARA PENGELUARAN MABES TNI&nbsp;</span>
          <span>KU TNI WILAYAH NUSRA NA. 1.01.12</span>
        </span>
        <div class="home-container01">
          <span class="home-text03" contenteditable="false">Denpasar, 15 Mei 2024</span>
        </div>
        <div class="home-container02">
          <div class="home-container03">
            <span class="home-text04">
              <span></span>
              <span>Nomor&nbsp;</span>
              <br />
              <span>Klasifikasi&nbsp;</span>
              <br />
              <span>Lampiran&nbsp;</span>
              <br />
              <span>Perihal</span>
            </span>
            <span class="home-text13">
              <span>:</span>
              <br />
              <span>:</span>
              <br />
              <span>:</span>
              <br />
              <span>:</span>
              <br />
            </span>
            <span class="home-text22" contenteditable="false">
              <span>B/66/V/2024</span>
              <br />
              <span>Biasa</span>
              <br />
              <span>Satu bendel</span>
              <br />
              <span>Pengajuan Penyaluran Dana KU TNI Wilayah Nusra</span>
              <br />
            </span>
          </div>
        </div>
        <div class="home-container04">
          <span class="home-text31">
            <span>Kepada.</span>
            <br />
          </span>
        </div>
        <div class="home-container05">
          <span class="home-text34">
            <span>Yth.</span>
            <br />
          </span>
          <span class="home-text37" contenteditable="false">
            <span>1. PPK Asops Mabes TNI</span>
            <br />
            <span>2. BP Kabidakdarglak Pusku</span>
            <br />
            <span>3. TNIKabidverdalku Pusku TNI</span>
            <br />
          </span>
        </div>
        <div class="home-container06">
          <span class="home-text44">
            <span>di</span>
            <br />
          </span>
        </div>
        <div class="home-container07">
          <span class="home-text47">
            <span>Jakarta</span>
            <br />
          </span>
        </div>
        <div class="home-container08">
          <div class="home-container09">
            <span class="home-text50">1.</span>
            <span class="home-text51">Dasar :</span>
          </div>
        </div>
        <span class="home-text52" contenteditable="false">
          a.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Keputusan Panglima TNI
          Nomor KEP/1411/XII/2023 tanggal 6 Desember 2023 tentang Petunjuk
          Pelaksanaan Program dan Anggaran UO Mabes TNI TA 2024.
        </span>
        <span class="home-text53" contenteditable="false">
          b.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Surat Perintah Pelaksanaan
          Anggaran Mabes TNI Nomor SPPA/263/A.01/2024 tanggal 2 Mei 2024 tentang
          Dukgar Giat Ops Pamtas, Pamtuper, Pamwawan dan Pam Ambalat bulan Mei
          2024.
        </span>
        <span class="home-text54" contenteditable="false">
          2.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Sehubungan dengan dasar
          tersebut di atas, dengan ini kami mohon dapatnya Benda Pengeluaran
          Mabes TNI dapat menyalurkan dana, sesuai dengan program dan anggaran
          yang kami terima sebesar Rp 2.801.020.500,- (Dua Miliar Delapan Ratus
          Satu Juta Dua Puluh Ribu Lima Ratus Rupiah) ke Rek. RPL 018 PBS MABES
          TNI KU PUM NUSRA No. Rek. Bank BNI 1743478780, (SPBy terlampir)
        </span>
        <span class="home-text55" contenteditable="false">
          3.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Demikian mohon dimaklumi
          dan mohon petunjuk lebih lanjut&nbsp;
        </span>
        <div class="home-container10">
          <div class="home-container11">
            <span class="home-text56" contenteditable="false">
              <span>Pgs. PUM TNI Wilayah Nusra</span>
              <br />
              <span>NA. 1.01.12</span>
              <br />
            </span>
          </div>
        </div>
        <div class="home-container12">
          <div class="home-container13">
            <input type="file" id="image-input" accept="image/*" style="display: none;">
            <label for="image-input" style="cursor: pointer;">
              <img id="signatureImage" src="" alt="Pilih Gambar" style="max-width:200px; " class="home-image">
            </label>        
          </div>
          
        </div>
        <div class="home-container14">
          <div class="home-container15">
            <span class="home-text61" contenteditable="false">
              <span>I Made Swastika</span>
              <br />
              <span>Mayor Chk NRP 2194032610573</span>
              <br />
            </span>
          </div>
        </div>
      </div>
      
      <div class="button-container">
        <button id="edit-button" onclick="toggleEdit()">Edit Isi Surat</button>
        <button onclick="selectImage()">Masukkan TTD Digital</button>
        
        <select id="font-select" onchange="changeFont(this.value)">
          <option value="">Default</option>
          <option value="Times New Roman">Times New Roman</option>
          <option value="Calibri">Calibri</option>
          <option value="Arial">Arial</option>
          <option value="Noto Sans">Noto Sans</option>
          <option value="Sans Serif">Sans Serif</option>
          <option value="Poppins">Poppins</option>
        </select>
      </div>
      <div class="button-container2">
        <button onclick="generatePDF()">Jadikan PDF</button>
        
        <a href="merge.html"><button>Tambahkan Lampiran</button></a>
        <button onclick="clearAllEditable()">Clear All Editable</button>
      </div>
      
    </div>

    <script>
      function toggleEdit() {
        const editButton = document.getElementById('edit-button');
        const editableElements = document.querySelectorAll('[contenteditable]');
      
        editableElements.forEach(element => {
          if (element.isContentEditable) {
            element.setAttribute('contenteditable', 'false');
            editButton.textContent = 'Edit Isi  Surat';
            editButton.classList.remove('save-mode');
          } else {
            element.setAttribute('contenteditable', 'true');
            editButton.textContent = 'Simpan';
            editButton.classList.add('save-mode');
          }
        });
      }
      
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script>
      function generatePDF() {
        const element = document.querySelector('.home-container'); // Target the specific container you want to export
        const options = {
          margin: 0,
          filename: 'document.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2, logging: true, dpi: 192, letterRendering: true },
          jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
          pagebreak: { mode: 'avoid-all' } // Prevent page breaks
        };

        const dialog = document.createElement('div');
        dialog.innerHTML = `
          <p>Choose an option:</p>
          <label for="filename">File Name:</label>
          <input type="text" id="filename" placeholder="Enter file name">
          <button id="savePDF">Save PDF</button>
          <button id="sendEmail">Send via Email</button>
          <button id="cancel">Cancel</button>
        `;
        dialog.style.position = 'fixed';
        dialog.style.top = '50%';
        dialog.style.left = '50%';
        dialog.style.transform = 'translate(-50%, -50%)';
        dialog.style.background = '#fff';
        dialog.style.padding = '20px';
        dialog.style.border = '2px solid #ccc';
        dialog.style.borderRadius = '5px';
        dialog.style.boxShadow = '0 0 10px rgba(0, 0, 0, 0.2)';
        dialog.style.zIndex = '9999';
  
        document.body.appendChild(dialog);
  
        // Function to remove the dialog
        const removeDialog = () => {
          document.body.removeChild(dialog);
        };
  
        // Event listeners for buttons
        document.getElementById('savePDF').addEventListener('click', () => {
          const fileName = document.getElementById('filename').value.trim() || 'document';
          options.filename = `${fileName}.pdf`;
          html2pdf().from(element).set(options).save();
          removeDialog();
        });
  
        document.getElementById('sendEmail').addEventListener('click', () => {
          const fileName = document.getElementById('filename').value.trim() || 'document';
          options.filename = `${fileName}.pdf`;
          const pdfBlob = new Blob([element.innerHTML], { type: 'application/pdf' });
          const pdfUrl = URL.createObjectURL(pdfBlob);
          window.open(`mailto:?subject=Document&body=Please find the attached document.&attachment=${pdfUrl}`, '_blank');
          removeDialog();
        });
  
        document.getElementById('cancel').addEventListener('click', () => {
          removeDialog();
        });
      }
  
      function changeFont(fontFamily) {
        // Set the font family for the body element
        document.body.style.fontFamily = fontFamily;
  
        // Remove the 'selected' class from all font buttons
        const fontButtons = document.querySelectorAll('.button-container button');
        fontButtons.forEach(button => button.classList.remove('selected'));
  
        // Add the 'selected' class to the clicked button
        const selectedButton = document.querySelector(`button[data-font="${fontFamily}"]`);
        selectedButton.classList.add('selected');
      }

    </script>
    <script>
      function selectImage() {
        const imageInput = document.getElementById('image-input');
        imageInput.click(); // Trigger click on hidden file input
      }
      
      // Function to handle image selection
      document.getElementById('image-input').addEventListener('change', function() {
        const signatureImage = document.getElementById('signatureImage');
        const file = this.files[0]; // Get the selected file
        if (file) {
          const reader = new FileReader(); // Create a FileReader object
          reader.onload = function(e) {
            signatureImage.src = e.target.result; // Set the image source to the selected file
            signatureImage.style.display = 'block'; // Display the image
            localStorage.setItem('image', e.target.result); // Save the image to local storage
          };
          reader.readAsDataURL(file); // Read the selected file as a data URL
        }
      });
      
    </script>
    <script>
      function changeFont(fontFamily) {
        // Set the font family for the body element
        if (fontFamily === "") {
          document.body.style.fontFamily = "inherit";
        } else {
          document.body.style.fontFamily = fontFamily;
        }
    
        // Remove the 'selected' class from all font buttons
        const fontButtons = document.querySelectorAll('.button-container button');
        fontButtons.forEach(button => button.classList.remove('selected'));
    
        // Add the 'selected' class to the clicked button
        const selectedButton = document.querySelector(`button[data-font="${fontFamily}"]`);
        selectedButton.classList.add('selected');
      }
    </script>
    <script>
      function clearAllEditable() {
        const editableElements = document.querySelectorAll('[contenteditable="false"]');
        editableElements.forEach(element => {
          switch (element.className) {
            case 'home-text':
              element.innerHTML = `
                <span class="placeholder">Masukkan Judul</span>`;
              break;
            case 'home-text03':
              element.innerHTML = '<span class="placeholder">Tempat, Tanggal</span>';
              break;
            case 'home-text22':
              element.innerHTML = `
                <span class="placeholder">Nomor</span> 
                <br />
                <span class="placeholder">Klasifikasi</span>                  <br />
                <span class="placeholder">Lampiran</span> 
                <br />
                <span class="placeholder">Perihal</span> 
                <br />
              `;
              break;
            case 'home-text37':
              element.innerHTML = `
                <span class="placeholder">1. </span>
                <br />
                <span class="placeholder">2. </span>
                <br />
                <span class="placeholder">3. </span>
                <br />
              `;
              break;
            case 'home-text52':
              element.innerHTML = `<span class="placeholder">a.</span>`;
              break;
            case 'home-text53':
              element.innerHTML = `<span class="placeholder">b.</span>`;
              break;
            case 'home-text54':
              element.innerHTML = `<span class="placeholder">2.</span>`;
              break;
            case 'home-text55':
              element.innerHTML = `<span class="placeholder">3.</span>`;
              break;
            case 'home-text56':
              element.innerHTML = `
                <span class="placeholder">Penandatangan</span>
              `;
              break;

              case 'home-text61':
              element.innerHTML = `
                <span class="placeholder">Nama Penanda Tangan</span>
              `;
              break;
      
            default:
              break;
          }
        });
      }

      
          </script>
  </body>
</html>
